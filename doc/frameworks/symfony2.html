<!DOCTYPE html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>PHP-DI - The Dependency Injection Container for humans</title>
    <meta name="description" content="PHP-DI is a Dependency Injection Container for PHP that intends to be practical and powerful">

    <link rel="canonical" href="http://php-di.org" />

    <meta name="application-name" content="PHP-DI"/>
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://php-di.org/img/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://php-di.org/img/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="http://php-di.org/img/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="http://php-di.org/img/favicon-16x16.png" sizes="16x16" />
    <meta name="msapplication-TileColor" content="#484949" />
    <meta name="msapplication-TileImage" content="http://php-di.org/img/mstile-144x144.png" />

            <link href="http://fonts.googleapis.com/css?family=Abel:400|Oswald:300,400,700" media="all" rel="stylesheet" type="text/css">
        <link href="http://php-di.org/css/highlight.github.css" rel="stylesheet">
        <link href="http://php-di.org/css/all.min.css" rel="stylesheet">
    
    <script>
        if (window.location.href.indexOf('http://mnapoli.fr') === 0) {
            window.location.href = 'http://php-di.org';
        }
    </script>
</head>
<body>

    <header>
        <div class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#top-navigation">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="http://php-di.org/">PHP-DI</a>
                </div>
                <div class="collapse navbar-collapse" id="top-navigation">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="http://php-di.org/doc/getting-started.html">Getting started</a></li>
                        <li><a href="http://php-di.org/doc/">Documentation</a></li>
                        <li><a href="http://php-di.org/news/">News</a></li>
                        <li><a href="http://php-di.org/change-log.html">Change log</a></li>
                        <li><a class="github" href="https://github.com/PHP-DI/PHP-DI"><i class="fa fa-github"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    
    <div class="container documentation">

        <div class="sidebar">
            <ul>
                                    <li>
                        Introduction

                        <ul>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/getting-started.html">
                                        Getting started
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/understanding-di.html">
                                        Understanding dependency injection
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/best-practices.html">
                                        "Best practices" guide
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        Usage

                        <ul>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/container-configuration.html">
                                        Configuring the container
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/container.html">
                                        Using the container
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        Definitions

                        <ul>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/definition.html">
                                        Introduction
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/autowiring.html">
                                        Autowiring
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/php-definitions.html">
                                        PHP definitions
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/annotations.html">
                                        Annotations
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/definition-overriding.html">
                                        Definition extensions and overriding
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        Frameworks

                        <ul>
                                                            <li class="active">
                                    <a href="http://php-di.org/doc/frameworks/symfony2.html">
                                        Symfony 2
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/frameworks/silex.html">
                                        Silex
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/frameworks/zf2.html">
                                        Zend Framework 2
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/frameworks/zf1.html">
                                        Zend Framework 1
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/frameworks/slim.html">
                                        Slim
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/frameworks/silly.html">
                                        Silly
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://github.com/PHP-DI/demo">
                                        Demo application
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        Advanced topics

                        <ul>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/performances.html">
                                        Performances
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/scopes.html">
                                        Scopes
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/lazy-injection.html">
                                        Lazy injection
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/inject-on-instance.html">
                                        Inject on an existing instance
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/environments.html">
                                        Injections depending on the environment
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/ide-integration.html">
                                        IDE integration
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        Migration guides

                        <ul>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/migration/4.0.html">
                                        From PHP-DI 3.x to 4.0
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/migration/5.0.html">
                                        From PHP-DI 4.x to 5.0
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        Internals

                        <ul>
                                                            <li class="">
                                    <a href="http://php-di.org/contributing.html">
                                        Contributing
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://php-di.org/doc/how-it-works.html">
                                        How PHP-DI works
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        Old documentation

                        <ul>
                                                            <li class="">
                                    <a href="https://github.com/PHP-DI/PHP-DI/tree/3.x/doc">
                                        PHP-DI 3.x
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://github.com/PHP-DI/PHP-DI/tree/4.x/doc">
                                        PHP-DI 4.x
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                            </ul>
        </div>

        <article>
            <div class="pull-right">
                <a href="https://github.com/PHP-DI/PHP-DI/blob/master/doc/frameworks/symfony2.md" class="btn btn-default btn-sm">
                    Edit this page on GitHub
                </a>
            </div>

            <h1 id="php-di-in-symfony-2">PHP-DI in Symfony 2</h1>
<p>If you are using Symfony 2, PHP-DI provides easy and clean integration, without replacing the original container
(so all bundles and existing code still work).</p>
<p>Just to be clear: PHP-DI will work alongside Symfony's container. So you can use both at the same time.</p>
<h2 id="installation">Installation</h2>
<p>First, install the bridge:</p>
<pre><code>composer require php-di/symfony2-bridge</code></pre>
<p>Now you need to configure Symfony to use the alternative container in your <code>AppKernel</code>:</p>
<pre><code class="language-php">class AppKernel extends Kernel
{
    /**
     * Gets the container's base class.
     *
     * @return string
     */
    protected function getContainerBaseClass()
    {
        return 'DI\Bridge\Symfony\SymfonyContainerBridge';
    }

    /**
     * Initializes the DI container.
     */
    protected function initializeContainer()
    {
        parent::initializeContainer();

        // Configure your container here
        // http://php-di.org/doc/container-configuration
        $builder = new \DI\ContainerBuilder();
        $builder-&gt;wrapContainer($this-&gt;getContainer());

        $this-&gt;getContainer()-&gt;setFallbackContainer($builder-&gt;build());
    }
}</code></pre>
<h2 id="usage">Usage</h2>
<p>You can now define <a href="http://symfony.com/doc/current/cookbook/controller/service.html">controllers as services</a>,
without any configuration, using PHP-DI's power!</p>
<p>Example for the routing configuration:</p>
<pre><code class="language-yaml">my_route:
    pattern:  /product-stock/clear
    defaults: { _controller: MyBundle\Controller\ProductController:clearAction }</code></pre>
<p><strong>Careful! Note that you need to use <code>:</code> as a separator, not <code>::</code> (else it will not go through the container).</strong>
The <code>:</code> notation means <code>service_id:method</code>, whereas the <code>::</code> notation means <code>class::method</code>.</p>
<p>Example with constructor injection:</p>
<pre><code class="language-php">class ProductController
{
    private $productService;

    public function __construct(ProductService $productService)
    {
        $this-&gt;productService = $productService;
    }

    public function clearAction()
    {
        $this-&gt;productService-&gt;clearStock();
    }
}</code></pre>
<p>Example with property injection:</p>
<pre><code class="language-php">class ProductController
{
    /**
     * @Inject
     * @var ProductService
     */
    private $productService;

    public function clearAction()
    {
        $this-&gt;productService-&gt;clearStock();
    }
}</code></pre>
<h3 id="routing-annotations">Routing annotations</h3>
<p>It is possible to use <a href="http://richardmiller.co.uk/2011/10/25/symfony2-routing-to-controller-as-service-with-annotations/">annotations for routing</a> and still have the controller created by PHP-DI.</p>
<p>You achieve that by specifying the service ID in the <code>@Route</code> annotation (which is most probably the class name itself unless you have a custom setup):</p>
<pre><code class="language-php">/**
 * @Route(service="My\TestController")
 */
class TestController extends Controller
{
    private $dependency;

    public function __construct(SomeDependency $dependency)
    {
        $this-&gt;dependency = $dependency;
    }

    /**
     * @Route("test")
     */
    public function testAction()
    {
        return new Response('ok');
    }
}</code></pre>
<h2 id="using-symfonys-services-in-php-di">Using Symfony's services in PHP-DI</h2>
<p>Let's say you want to inject the <code>EntityManager</code> in your controller: the entity manager is defined
in Symfony's container, and the controller is resolved by PHP-DI.</p>
<p><strong>You can reference services that are in Symfony's container in PHP-DI's configuration</strong>.
That's because PHP-DI is designed to play nice with others:</p>
<pre><code class="language-php">return [
    'Acme\MyBundle\Controller\ProductController' =&gt; DI\object()
        -&gt;constructor(DI\get('doctrine.orm.entity_manager')),
];</code></pre>
<p>However Symfony was not designed to play with his friends, so it has no idea that there is
another container in the application. <strong>You can't inject PHP-DI's services in a Symfony service</strong>.
That's however rarely a problem.</p>
<h3 id="service-name-aliases">Service name aliases</h3>
<p>PHP-DI can also work with autowiring or annotations. These rely on the fact that the service name
is the class name (or interface name), e.g. you reference the entity manager by its class name
instead of <code>doctrine.orm.entity_manager</code>.</p>
<p>If you want to enjoy autowiring or annotations, you can simplify your life and write simple aliases
like these:</p>
<pre><code class="language-php">return [
    'Psr\Log\LoggerInterface' =&gt; DI\get('logger'),
    // PHP 5.5 notation:
    ObjectManager::class =&gt; DI\get('doctrine.orm.entity_manager'),
];</code></pre>
<p>Keep in mind that it's always better to type-hint against interfaces instead of class names!
So write your aliases with interfaces as much as possible.</p>
<h2 id="fosrestbundle">FOSRestBundle</h2>
<p>There was a bug in FOSRestBundle that would prevent using &quot;Controller as services&quot; in some cases.</p>
<p>This bug has been fixed and will be released in &gt;=1.3.2 (not released yet at the time of writing).</p>
<p>Full details are here: <a href="https://github.com/FriendsOfSymfony/FOSRestBundle/pull/743">FOSRestBundle#743</a></p>
<h2 id="more">More</h2>
<p>Read more on the <a href="https://github.com/PHP-DI/Symfony2-Bridge">Symfony2-Bridge project on GitHub</a>.</p>
        </article>

    </div>


            <footer>
            <div class='container'>
                                    <p>
                        A question? Unsatisfied with the documentation?
                        Please <a href="https://github.com/PHP-DI/PHP-DI/issues/new">create an issue</a>
                        or chat on
                        <a href="https://gitter.im/PHP-DI/PHP-DI">Gitter</a> or
                        <a href="https://twitter.com/phpdi">Twitter</a>.
                    </p>
                                <p>
                    <a href="https://twitter.com/share" class="twitter-share-button" data-related="PHPDI" data-dnt="true">Tweet</a>
                    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                </p>
                <p>
                    By <a href="http://mnapoli.fr/">Matthieu Napoli</a>
                    and <a href="https://github.com/PHP-DI/PHP-DI/graphs/contributors">contributors</a>
                    |
                    Website generated with
                    <a href="http://couscous.io" target="_blank">Couscous</a>.
                </p>
            </div>
        </footer>
    
            <script src="http://php-di.org/bower_components/jquery/dist/jquery.min.js"></script>
        <script src="http://php-di.org/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>

        <script>
            $(function() {
                hljs.initHighlightingOnLoad();

                // Add anchors to headers
                $('article h2, article h3, article h4, article h5').each(function () {
                    var url = document.URL.replace(/#.*$/, "") + '#' + $(this).attr('id');
                    $(this).append(' <a class="anchor" href="' + url + '">#</a>');
                });
            });
        </script>
    
    <script>
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-15584647-13']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

    <!-- Gitter -->
    <script>
        ((window.gitter = {}).chat = {}).options = {
            room: 'PHP-DI/PHP-DI'
        };
    </script>
    <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

</body>
</html>
